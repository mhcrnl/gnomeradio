# Note that this is NOT a relocatable package
%define ver      @VERSION@
%define rel      1
%define prefix   /usr

Summary: A FM-Tuner program for Gnome
Name: gnomeradio
Version: %ver
Release: %rel
Copyright: GPL
Group: Applications/Multimedia
Source: http://mfcn.ilo.de/gnomeradio/gnomeradio-%{ver}.tar.gz
BuildRoot: /var/tmp/gnomeradio-%{ver}-root
Packager: Jörgen Scheibengruber <mfcn@gmx.de>
URL: http://mfcn.ilo.de/gnomeradio
Docdir: %{prefix}/doc

BuildRequires: pkgconfig
BuildRequires: intltool
BuildRequires: libgnomeui-devel

%description
A FM-Tuner program for Gnome

%changelog

%prep
%setup

%build
CFLAGS="${RPM_OPT_FLAGS}"
CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=%prefix
make

%install
rm -rf $RPM_BUILD_ROOT
export GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1
make prefix=$RPM_BUILD_ROOT%{prefix} install
%makeinstall
unset GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-, root, root)

%doc ABOUT-NLS AUTHORS COPYING ChangeLog INSTALL NEWS README

%{prefix}/bin/*
%{prefix}/share/locale/*
%{prefix}/share/pixmaps/radio.png
%{prefix}/share/pixmaps/gnome-radio.png
%{prefix}/share/gnome/apps/Multimedia/gnomeradio.desktop

%post
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
SCHEMAS="gnomeradio.schemas"
for S in $SCHEMAS; do
  gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/$S > /dev/null
done
